CREATE OR REPLACE PROCEDURE PRC_CURSOR_EXAMPLE IS
W_P_CODE	PRODUCT.P_CODE%TYPE;
W_P_DESCRIPT	PRODUCT.P_DESCRIPT%TYPE;
W_TOT		NUMBER(3);
CURSOR PROD_CURSOR IS
   SELECT P_CODE, P_DESCRIPT
      FROM PRODUCT
      WHERE P_ONHAND > (SELECT AVG(P_ONHAND) FROM PRODUCT);
BEGIN
DBMS_OUTPUT.PUT_LINE('PRODUCTS WITH P_ONHAND > AVG(P_ONHAND)');
DBMS_OUTPUT.PUT_LINE('======================================');
OPEN PROD_CURSOR;
LOOP
   FETCH PROD_CURSOR INTO W_P_CODE, W_P_DESCRIPT;
   EXIT WHEN PROD_CURSOR%NOTFOUND;
   DBMS_OUTPUT.PUT_LINE(W_P_CODE ||' -> ' || W_P_DESCRIPT );
END LOOP;
DBMS_OUTPUT.PUT_LINE('======================================');
DBMS_OUTPUT.PUT_LINE('TOTAL PRODUCT PROCESSED ' || PROD_CURSOR%ROWCOUNT); 
DBMS_OUTPUT.PUT_LINE('--- END OF REPORT ----');
CLOSE PROD_CURSOR;
END;
/



